Yandex Disk Monitor

Мониторинг изменений в Яндекс.Диске: отслеживание добавления, удаления и изменения файлов и папок с отправкой email-уведомлений.

Что делает проект
	•	Рекурсивно проверяет указанную папку на Яндекс.Диске
	•	Обнаруживает:
	•	➕ добавленные файлы и папки
	•	✏️ изменённые файлы и папки
	•	➖ удалённые файлы и папки
	•	Отправляет email-уведомление с кратким описанием изменений

⸻

Структура проекта

yandex-disk-monitor/
├── .github/workflows/
│   └── monitor.yml       # GitHub Actions для автоматического запуска
├── disk_folder_monitor_once.py  # Основной скрипт мониторинга
├── previous_state.json   # Хранит предыдущее состояние диска
├── notified_etags.json   # Хранит уже уведомленные etag-файлы


Переменные окружения (GitHub Secrets)

Проект использует переменные окружения, которые должны быть заданы в GitHub Actions (в разделе Settings → Secrets → Actions):

Переменная	Описание
YANDEX_TOKEN	OAuth токен для доступа к Яндекс.Диску
EMAIL_FROM	Email-отправитель (тот же, что и в почте Яндекса)
EMAIL_PASS	Пароль приложения от почты Яндекса
EMAIL_TO	Email-получатели (через запятую)
FOLDER_PATH	Путь на Яндекс.Диске, например: disk:/Финальные версии заявок и ОТО по проектам


Как изменить отслеживаемую папку

Измени переменную окружения FOLDER_PATH на нужную:

disk:/Документы/Отчёты


Как изменить адреса уведомлений

Измени EMAIL_TO (через запятую, если несколько):

EMAIL_TO = e.mareeva@protelematics.ru, all@protelematics.ru


Как работает сравнение

Скрипт сохраняет previous_state.json и сравнивает его с текущим содержимым:
	•	сравнивает пути
	•	проверяет etag и modified

Как работает GitHub Actions

Автоматически запускается каждые 15 минут (можно изменить cron):

on:
  schedule:
    - cron: '*/15 * * * *'


Ограничения тарифа “Минимальный”

На текущем тарифе невозможно определить, кто изменил файл, так как API /journal недоступен.

Для получения этой информации необходимо перейти на тариф “Оптимальный” или выше.


Поддержка и обновления

Если необходимо:
	•	добавить фильтрацию по типу файлов
	•	отслеживать только изменения (без новых файлов)
	•	сделать лог в файл — добавь issue или настрой дополнительную логику в disk_folder_monitor_once.py
