# Yandex Disk Monitor

–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫–µ: –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è, —É–¥–∞–ª–µ–Ω–∏—è –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –∏ –ø–∞–ø–æ–∫ —Å –æ—Ç–ø—Ä–∞–≤–∫–æ–π email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.

## –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç

- üîÅ –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —É–∫–∞–∑–∞–Ω–Ω—É—é –ø–∞–ø–∫—É –Ω–∞ –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫–µ
- üìå –û–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç:
  - ‚ûï **–î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ** —Ñ–∞–π–ª—ã –∏ –ø–∞–ø–∫–∏
  - ‚úèÔ∏è **–ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ** —Ñ–∞–π–ª—ã –∏ –ø–∞–ø–∫–∏
  - ‚ûñ **–£–¥–∞–ª—ë–Ω–Ω—ã–µ** —Ñ–∞–π–ª—ã –∏ –ø–∞–ø–∫–∏
- ‚úâÔ∏è –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –∫—Ä–∞—Ç–∫–∏–º –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
yandex-disk-monitor/
‚îú‚îÄ‚îÄ .github/workflows/
‚îÇ   ‚îî‚îÄ‚îÄ monitor.yml             # GitHub Actions –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
‚îú‚îÄ‚îÄ disk_folder_monitor_once.py # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
‚îú‚îÄ‚îÄ previous_state.json         # –•—Ä–∞–Ω–∏—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–∏—Å–∫–∞
‚îú‚îÄ‚îÄ notified_etags.json         # –•—Ä–∞–Ω–∏—Ç —É–∂–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–Ω—ã–µ etag-—Ñ–∞–π–ª—ã
```
## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (GitHub Secrets)

–í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—é—Ç—Å—è –≤ GitHub:  
`Settings ‚Üí Secrets and variables ‚Üí Actions`

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è     | –û–ø–∏—Å–∞–Ω–∏–µ                                                        |
|----------------|-----------------------------------------------------------------|
| `YANDEX_TOKEN` | OAuth —Ç–æ–∫–µ–Ω –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫—É                          |
| `EMAIL_FROM`   | Email-–æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å (–¥–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –ø–æ—á—Ç–æ–π, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π –ø–∞—Ä–æ–ª—å) |
| `EMAIL_PASS`   | –ü–∞—Ä–æ–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ—Ç –ø–æ—á—Ç—ã –Ø–Ω–¥–µ–∫—Å–∞                              |
| `EMAIL_TO`     | Email-–ø–æ–ª—É—á–∞—Ç–µ–ª–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)                                |
| `FOLDER_PATH`  | –ü—É—Ç—å –Ω–∞ –î–∏—Å–∫–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä: `disk:/–§–∏–Ω–∞–ª—å–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –∑–∞—è–≤–æ–∫ –∏ –û–¢–û`  |

## –ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—É—é –ø–∞–ø–∫—É

–ò–∑–º–µ–Ω–∏ `FOLDER_PATH`:

```env
FOLDER_PATH=disk:/–î–æ–∫—É–º–µ–Ω—Ç—ã/–û—Ç—á—ë—Ç—ã
```

## –ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

–ò–∑–º–µ–Ω–∏ `EMAIL_TO` (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é):

```env
EMAIL_TO=all@protelematics.ru
```

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ

- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è `previous_state.json`
- –ü—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç—Å—è:
  - –ø—É—Ç–∏ (`path`)
  - –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Å—É–º–º—ã (`etag`)
  - –¥–∞—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è (`modified`)

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç GitHub Actions

–ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç** (–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å):

```yaml
on:
  schedule:
    - cron: '*/15 * * * *'
```

–¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É `Run workflow`.

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ç–∞—Ä–∏—Ñ–∞ ¬´–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π¬ª

–ù–∞ —Ç–∞—Ä–∏—Ñ–µ **¬´–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π¬ª**:
- ‚ùå –ù–µ–ª—å–∑—è –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, **–∫—Ç–æ –∏–º–µ–Ω–Ω–æ** –∏–∑–º–µ–Ω–∏–ª —Ñ–∞–π–ª (–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç API `/journal`)

üëâ –ß—Ç–æ–±—ã —ç—Ç–æ —Å—Ç–∞–ª–æ –≤–æ–∑–º–æ–∂–Ω—ã–º ‚Äî –ø–µ—Ä–µ–π–¥–∏ –Ω–∞ —Ç–∞—Ä–∏—Ñ **¬´–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π¬ª** –∏–ª–∏ –≤—ã—à–µ.
